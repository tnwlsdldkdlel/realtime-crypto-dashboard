# 작업 계획서 (Work Plan)

## 📋 프로젝트 현황

### ✅ 완료된 작업
- [x] Next.js 프로젝트 초기화 (TypeScript, Tailwind CSS)
- [x] 프로젝트 구조 및 아키텍처 설정
- [x] 타입 정의 (도메인 타입, Binance API 타입)
- [x] 어댑터 패턴 구현 (Binance API 어댑터)
- [x] 리포지토리 인터페이스 정의
- [x] Zustand 스토어 (티커, 즐겨찾기)
- [x] WebSocket 클라이언트 기본 구조
- [x] Next.js API Routes (코인 목록, Kline)
- [x] 유틸리티 함수 (스로틀링, 디바운스)
- [x] Vitest 테스트 프레임워크 설정 및 테스트 코드 작성
- [x] GitHub Actions CI/CD 파이프라인 설정 (ESLint, Vitest, 빌드 테스트)
- [x] 다크 테마 UI 적용
- [x] 개발 서버 스크립트 (포트 자동 관리)

---

## 🎯 작업 단계별 계획

### Phase 1: 기본 UI 및 데이터 페칭 (Foundation)
**목표**: 기본 UI 구조와 서버 사이드 데이터 페칭 구현

#### 1.1 서버 사이드 데이터 페칭 구현
- [x] 메인 페이지에서 Server Components로 초기 코인 목록 페칭
- [x] API Routes 테스트 및 에러 핸들링 개선
- [x] 데이터 캐싱 전략 구현 (API Routes에 캐시 헤더 적용)

#### 1.2 기본 레이아웃 및 UI 컴포넌트
- [x] 헤더/네비게이션 컴포넌트 (Header 컴포넌트 생성)
- [x] 로딩 스피너 컴포넌트 (LoadingSpinner 컴포넌트 생성)
- [x] 에러 메시지 컴포넌트 (ErrorMessage 컴포넌트 분리 및 개선)
- [x] 기본 레이아웃 스타일링 (다크 테마 적용, 레이아웃 통합)

**예상 소요 시간**: 1-2일

---

### Phase 2: 실시간 코인 목록 구현 (RCD-F1)
**목표**: 실시간 업데이트되는 코인 목록 표시

#### 2.1 코인 목록 컴포넌트 기본 구조
- [x] `CoinListClient` 컴포넌트 생성 (기본 구조)
- [ ] 테이블/리스트 레이아웃 디자인 (현재 카드 형태)
- [x] 기본 데이터 표시 (심볼, 가격, 변동률 등)

#### 2.2 WebSocket 통합 및 실시간 업데이트
- [ ] WebSocket 훅 생성 (`useBinanceWebSocket`)
- [ ] 메인 페이지에서 WebSocket 연결 및 티커 스트림 구독
- [ ] 실시간 데이터를 Zustand 스토어에 업데이트
- [ ] 컴포넌트에서 스토어 구독 및 렌더링

#### 2.3 목록 가상화 구현
- [ ] TanStack Virtual 통합
- [ ] 가상화된 리스트 컴포넌트 구현
- [ ] 성능 테스트 및 최적화

#### 2.4 정렬 및 필터링 기능
- [ ] 정렬 기능 구현 (가격, 변동률, 거래량 등)
- [ ] 필터링 기능 구현 (심볼 검색)
- [ ] 정렬/필터 상태 관리

**예상 소요 시간**: 2-3일

---

### Phase 3: 시각적 피드백 및 애니메이션 (RCD-UX1)
**목표**: 실시간 데이터 변경에 대한 부드러운 시각적 피드백

#### 3.1 가격 변경 하이라이트
- [ ] 가격 변경 감지 로직 구현
- [ ] 300ms 소프트 하이라이트 애니메이션 구현
- [ ] 색상 트랜지션 (상승: 녹색, 하락: 빨간색)

#### 3.2 시각적 계층 구조
- [ ] 현재가 및 변동률 강조 스타일링
- [ ] 폰트 크기 및 색상 계층 구조 적용
- [ ] 반응형 디자인 고려

#### 3.3 애니메이션 스로틀링
- [ ] 100ms 단위 애니메이션 제한 구현
- [ ] `requestAnimationFrame` 기반 애니메이션 최적화

**예상 소요 시간**: 1-2일

---

### Phase 4: 즐겨찾기 기능 구현 (RCD-F3)
**목표**: 관심 코인 관리 및 WebSocket 구독 자동 조정

#### 4.1 즐겨찾기 UI 구현
- [ ] 즐겨찾기 버튼/아이콘 컴포넌트
- [ ] 즐겨찾기 목록 표시 컴포넌트
- [ ] 즐겨찾기 토글 기능

#### 4.2 WebSocket 구독 자동 조정
- [ ] 즐겨찾기 변경 시 WebSocket 재구독 로직
- [ ] 디바운스된 재연결 구현 (300ms)
- [ ] 구독 상태 관리 및 UI 피드백

**예상 소요 시간**: 1일

---

### Phase 5: 인터랙티브 차트 구현 (RCD-F2)
**목표**: 실시간 캔들스틱 차트 표시

#### 5.1 차트 컴포넌트 기본 구조
- [ ] Lightweight Charts 통합
- [ ] 차트 컨테이너 컴포넌트 생성
- [ ] 기본 캔들스틱 차트 렌더링

#### 5.2 과거 데이터 페칭 및 표시
- [ ] 코인 선택 시 과거 OHLCV 데이터 페칭
- [ ] 차트에 과거 데이터 표시
- [ ] 로딩 상태 처리

#### 5.3 실시간 Kline 스트림 통합
- [ ] WebSocket Kline 스트림 구독
- [ ] 실시간 데이터와 과거 데이터 병합 로직
- [ ] `openTime` 기준 갱신/추가 결정

#### 5.4 데이터 간격(Gap) 처리
- [ ] 데이터 간격 감지 로직
- [ ] REST API를 통한 간격 메우기
- [ ] 데이터 정합성 보장

#### 5.5 차트 인터랙션
- [ ] 차트 상세 페이지/모달 구현
- [ ] 줌, 패닝 기능 활용
- [ ] 시간대 선택 기능

**예상 소요 시간**: 3-4일

---

### Phase 6: 에러 핸들링 및 폴백 (RCD-R1)
**목표**: 강건한 에러 처리 및 복구 메커니즘

#### 6.1 WebSocket 에러 핸들링
- [ ] 연결 실패 감지 및 UI 표시
- [ ] 지수 백오프 재연결 로직 개선
- [ ] 재연결 시도 횟수 제한 및 사용자 알림

#### 6.2 Degraded Mode 구현
- [ ] WebSocket 실패 시 REST 폴링 모드 전환
- [ ] 폴링 간격 설정 (예: 5초)
- [ ] 모드 전환 UI 표시

#### 6.3 REST API Rate Limit 처리
- [x] 429 에러 감지 및 `Retry-After` 헤더 처리 (API Routes에 구현)
- [x] 스로틀링 구현 (utils/throttle.ts)
- [ ] 캐시된 데이터 우선 사용 로직
- [ ] "요청 지연" 메시지 및 재시도 버튼

#### 6.4 전역 에러 바운더리
- [ ] React Error Boundary 구현
- [ ] 에러 로깅 및 사용자 친화적 메시지

**예상 소요 시간**: 2일

---

### Phase 7: 성능 최적화 및 통계
**목표**: 성능 측정 및 최적화

#### 7.1 성능 통계 페이지
- [ ] 성능 통계 컴포넌트 생성
- [ ] 현재 구독 중인 심볼 수 표시
- [ ] 초당 업데이트 수 측정 및 표시
- [ ] WebSocket 연결 상태 표시

#### 7.2 성능 최적화
- [ ] React.memo를 통한 불필요한 리렌더링 방지
- [ ] useMemo, useCallback 최적화
- [ ] 번들 크기 최적화
- [ ] 이미지 최적화 (필요시)

#### 7.3 성능 측정 및 문서화
- [ ] Lighthouse 성능 측정
- [ ] Web Vitals 측정
- [ ] 성능 지표 문서화

**예상 소요 시간**: 1-2일

---

### Phase 8: 문서화 및 마무리
**목표**: 프로젝트 문서화 및 배포 준비

#### 8.1 문서 작성
- [ ] 아키텍처 문서 작성 (`docs/architecture.md`)
- [ ] 실시간 전략 문서 작성 (`docs/realtime-strategy.md`)
- [ ] 성능 분석 문서 작성 (`docs/performance.md`)
- [ ] API 문서 작성

#### 8.2 README 업데이트
- [ ] Live Demo 링크 추가
- [ ] 기술 하이라이트 섹션 보강
- [ ] 성능 측정치 추가
- [ ] 스크린샷 추가

#### 8.3 코드 품질 개선
- [x] ESLint 규칙 검토 및 수정 (기본 오류 수정 완료)
- [x] TypeScript 타입 안정성 검토 (기본 타입 정의 완료)
- [ ] 코드 주석 및 JSDoc 추가

#### 8.4 배포 준비
- [ ] 환경 변수 설정 가이드
- [ ] 배포 스크립트 작성
- [ ] Vercel 배포 설정

**예상 소요 시간**: 1-2일

---

## 📊 전체 일정 요약

| Phase | 작업 내용 | 예상 소요 시간 |
| :--- | :--- | :--- |
| **Phase 1** | 기본 UI 및 데이터 페칭 | 1-2일 |
| **Phase 2** | 실시간 코인 목록 구현 | 2-3일 |
| **Phase 3** | 시각적 피드백 및 애니메이션 | 1-2일 |
| **Phase 4** | 즐겨찾기 기능 구현 | 1일 |
| **Phase 5** | 인터랙티브 차트 구현 | 3-4일 |
| **Phase 6** | 에러 핸들링 및 폴백 | 2일 |
| **Phase 7** | 성능 최적화 및 통계 | 1-2일 |
| **Phase 8** | 문서화 및 마무리 | 1-2일 |
| **총계** | | **12-18일** |

---

## 🎯 우선순위

### 높은 우선순위 (MVP)
1. Phase 1: 기본 UI 및 데이터 페칭
2. Phase 2: 실시간 코인 목록 구현
3. Phase 3: 시각적 피드백 및 애니메이션
4. Phase 4: 즐겨찾기 기능 구현

### 중간 우선순위
5. Phase 5: 인터랙티브 차트 구현
6. Phase 6: 에러 핸들링 및 폴백

### 낮은 우선순위 (Polish)
7. Phase 7: 성능 최적화 및 통계
8. Phase 8: 문서화 및 마무리

---

## 🔄 개발 워크플로우

1. **기능 브랜치 생성**: `git checkout -b feature/phase-1-basic-ui`
2. **작업 진행**: 각 Phase의 작업 항목 순차적으로 구현
3. **커밋**: 의미 있는 단위로 커밋 (`feat:`, `fix:`, `refactor:` 등)
4. **테스트**: 각 기능 구현 후 수동 테스트
5. **리뷰**: 코드 리뷰 및 개선사항 반영
6. **병합**: `main` 브랜치로 병합

---

## 📝 참고사항

- 각 Phase는 독립적으로 작업 가능하지만, Phase 1-2는 다른 Phase의 기반이 됩니다.
- WebSocket 통합은 Phase 2에서 시작되며, 이후 Phase에서 지속적으로 개선됩니다.
- 성능 최적화는 각 Phase에서 지속적으로 고려해야 합니다.
- 에러 핸들링은 초기부터 구현하는 것이 좋지만, Phase 6에서 체계적으로 정리합니다.

